<html lang='en'>
<head>
<meta charset='utf-8' />
</head>
<body onload="main()">
<div id='sifPlayer'></div>
<canvas id="canvas" width="640" height="480" style = "position: absolute; top:10px; left: 10px"></canvas>
<canvas id="canvas2" width="640" height="480" style = "position: absolute; top:10px; left: 10px"></canvas>
<script type='text/javascript' src="libs/Ticker.js"></script>
<script type='text/javascript' src="libs/tweenjs-0.3.0.min.js"></script>
<script type='text/javascript' src="src/sifplayer.js"></script>
<script type='text/javascript' src="src/Ease.js"></script>
<script type='text/javascript' src="src/sifobject.js"></script>
<script type='text/javascript' src="src/Layers/Layer.js"></script>
<script type='text/javascript' src="src/Layers/PasteCanvas.js"></script>
<script type='text/javascript' src="src/Layers/region.js"></script>
<script type='text/javascript' src="src/Layers/restore.js"></script>
<script type='text/javascript' src="src/Layers/translate.js"></script>
<script type='text/javascript' src="src/Layers/rotate.js"></script>
<script type='text/javascript' src="src/Layers/zoom.js"></script>
<script type='text/javascript' src="src/Layers/import.js"></script>
<script type='text/javascript' src="src/Layers/circle.js"></script>
<script type='text/javascript' src="src/Layers/linear_gradient.js"></script>
<script type='text/javascript' src="src/Layers/radial_gradient.js"></script>
<script type='text/javascript' src="src/Layers/stretch.js"></script>
<script type='text/javascript'>
function main() {
	var xmlDoc = loadXML('assets/test.sif');
	var canvas = document.getElementById('canvas');
	var canvas2 = document.getElementById('canvas2');

	var so = new sifPlayer.SifObject(xmlDoc, 0, 0, canvas.width, canvas.height, 'assets/');
	so.timeline.loop = true;
	so.timeline.setPaused( false );


	var looper = {
		Buffers: [canvas, canvas2],
		Contexts: [canvas.getContext('2d'), canvas2.getContext('2d')],
		DrawingBuffer: 0,
		
		
		tick: function () {
			var ctx = this.Contexts[this.DrawingBuffer];
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			so.draw(ctx);
			this.flip();
		
		},
		
		flip: function () {
			this.Buffers[1-this.DrawingBuffer].style.visibility='hidden';
			this.Buffers[this.DrawingBuffer].style.visibility='visible';

			this.DrawingBuffer=1-this.DrawingBuffer;
		}
			
	}
	
	createjs.Ticker.useRaf = false;
	createjs.Ticker.addListener(looper);
}

function loadXML (file) {
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		var xmlhttp=new XMLHttpRequest();

	} else {// code for IE6, IE5
		var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	xmlhttp.open("GET",file,false);
	xmlhttp.send();
	var xmlDoc=xmlhttp.responseXML;
	return xmlDoc;
}

</script>
</body>
</html>
