/*
 Copyright (c) 2012 haramanai.
 sifPlayer
 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
*/
this.sifPlayer=this.sifPlayer||{};
(function(){sifPlayer._getData=function(g){function e(b,d){a[b]?(a[b].constructor!=Array&&(a[b]=[a[b]]),a[b][a[b].length]=d):a[b]=d}var a={},b,d,f;for(b=0;d=g.attributes[b];b++)e("_"+d.name,sifPlayer._toSifValue(d.value));for(b=0;d=g.childNodes[b];b++)if(1==d.nodeType)if(f=d.nodeName,1==d.childNodes.length&&3==d.firstChild.nodeType)e(d.nodeName,sifPlayer._toSifValue(d.firstChild.nodeValue));else switch(f){case "param":a[d.getAttribute("name")]=sifPlayer._getData(d);break;case "layer":"undefined"==
typeof a[f]&&(a[f]=[]);switch(d.getAttribute("type")){case "rotate":case "translate":case "zoom":case "stretch":e("layer",{_type:"restore"});a.layer.unshift(sifPlayer._getData(d));break;default:e(d.nodeName,sifPlayer._getData(d))}break;case "waypoint":"undefined"==typeof a[f]&&(a[f]=[]);default:e(f,sifPlayer._getData(d))}return a};sifPlayer._secsToMillis=function(g){return 1E3*parseFloat(g.replace("s",""))};sifPlayer._canvasTimeToMillis=function(g,e){var a=0,b;0<g.search("h")&&(b=g.split("h"),a+=
36E5*b[0],g=b[1]);0<g.search("m")&&(b=g.split("m"),a+=6E4*b[0],g=b[1]);0<g.search("s")&&(b=g.split("s"),a+=1E3*b[0],g=b[1]);0<g.search("f")&&(b=g.split("f"),a+=1E3*b[0]/e);return a};sifPlayer._getLayer=function(g,e){if(sifPlayer[e._type])return new sifPlayer[e._type](g,e);if("import"===e._type)return new sifPlayer.Import(g,e);console.log("EERRROOR  "+e._type+" layer it's not supported");var a=new sifPlayer.Layer;a.initLayer(g,e);return a};sifPlayer._toSifValue=function(g){var e=Number(g);return!isNaN(e)?
e:"true"===g?!0:"false"===g?!1:":"===g[0]?g.substr(1):g};sifPlayer._getEase=function(g){return"linear"===g||"clamped"===g||"halt"===g?createjs.Ease.none:"constant"===g?sifPlayer.Ease.constant:"auto"===g?createjs.Ease.none:!1};window.sifPlayer=sifPlayer})();(function(){function g(a){this.ctx=a;this.matrix=[1,0,0,1,0,0];this.stack=[];this.setTransform()}var e=g.prototype;e.setContext=function(a){this.ctx=a};e.getMatrix=function(){return this.matrix};e.setMatrix=function(a){this.matrix=[a[0],a[1],a[2],a[3],a[4],a[5]];this.setTransform()};e.cloneMatrix=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5]]};e.save=function(){var a=this.cloneMatrix(this.getMatrix());this.stack.push(a);this.ctx&&this.ctx.save()};e.restore=function(){if(0<this.stack.length){var a=
this.stack.pop();this.setMatrix(a)}this.ctx&&this.ctx.restore()};e.setTransform=function(){this.ctx&&this.ctx.setTransform(this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5])};e.translate=function(a,b){this.matrix[4]+=this.matrix[0]*a+this.matrix[2]*b;this.matrix[5]+=this.matrix[1]*a+this.matrix[3]*b;this.setTransform()};e.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),d=this.matrix[1]*b+this.matrix[3]*a,f=this.matrix[0]*-a+this.matrix[2]*b,e=this.matrix[1]*
-a+this.matrix[3]*b;this.matrix[0]=this.matrix[0]*b+this.matrix[2]*a;this.matrix[1]=d;this.matrix[2]=f;this.matrix[3]=e;this.setTransform()};e.scale=function(a,b){this.matrix[0]*=a;this.matrix[1]*=a;this.matrix[2]*=b;this.matrix[3]*=b;this.setTransform()};sifPlayer.Tracker=g})();(function(){Ease={constant:function(g){return 1>g?0:1},bool:function(g){return 1>g?1:0}};sifPlayer.Ease=Ease})();(function(){function g(a,b){if(b)for(c in b)this[c]=b[c];this.sifPath=this.sifPath||"";this.init(a);this.canvas=document.createElement("canvas")}var e=g.prototype;e.x=0;e.y=0;e.width=320;e.height=240;e.sifPath="";e.timeline=null;e.desc={};e.init=function(a){a=sifPlayer._getData(a.getElementsByTagName("canvas")[0]);this.timeline=new createjs.Timeline;this.timeline.setPaused(!0);this._getCanvasData(a)};e.draw=function(a){var b=this.sif.canvas,d=b.track=new sifPlayer.Tracker(a),f=this.sif.canvas.layer,
e=b.bgcolor;a.clearRect(this.x,this.y,this.width,this.height);a.beginPath();a.rect(this.x,this.y,this.width,this.height);a.closePath();a.clip();d.save();d.setMatrix([this.width/(b.view_box[2]-b.view_box[0]),0,0,this.height/(b.view_box[3]-b.view_box[1]),this.x+this.width/2,this.y+this.height/2]);for(var b=0,g=f.length;b<g;b++)f[b].draw(d);d.restore();a.globalAlpha=1;a.globalCompositeOperation="destination-over";a.fillStyle="rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")";a.fillRect(this.x,this.y,this.width,
this.height)};e._getCanvasData=function(a){this.sif={};this.sif.canvas={};this.sif.canvas.version=a._version;this.sif.canvas.width=a._width;this.sif.canvas.height=a._height;var b=a["_view-box"].split(" ");this.sif.canvas.view_box=[parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3])];this.sif.canvas.antialias=a._antialias;this.sif.canvas.fps=a._fps;this.sif.canvas.begin_time=sifPlayer._canvasTimeToMillis(a["_begin-time"],this.sif.canvas.fps);this.sif.canvas.end_time=sifPlayer._canvasTimeToMillis(a["_end-time"],
this.sif.canvas.fps);b=a._bgcolor.split(" ");this.sif.canvas.bgcolor={};this.sif.canvas.bgcolor.r=Math.round(256*parseFloat(b[0]));this.sif.canvas.bgcolor.g=Math.round(256*parseFloat(b[1]));this.sif.canvas.bgcolor.b=Math.round(256*parseFloat(b[2]));this.sif.canvas.bgcolor.a=parseFloat(b[3]);this.sif.canvas.name=a.name;this.sif.canvas.defs=this._getDefs(a.defs);this.sif.canvas.layer=[];this.timeline.duration=this.sif.canvas.end_time;for(b=0;b<a.layer.length;b++)this.sif.canvas.layer.push(sifPlayer._getLayer(this,
a.layer[b]))};e._getDefs=function(a){var b={};for(name in a)if(a[name].constructor!=Array)"animated"===name?(b[a[name]._id]={},b[a[name]._id].animated=a[name]):(b[a[name]._id]={},b[a[name]._id][name]=a[name],b[a[name]._id]._type=name);else for(var d=0;d<a[name].length;d++)"animated"===name?(b[a[name][d]._id]={},b[a[name][d]._id].animated=a[name][d]):(b[a[name][d]._id]={},b[a[name][d]._id][name]=a[name][d],b[a[name][d]._id]._type=name);return b};sifPlayer.SifObject=g})();this.sifPlayer=this.sifPlayer||{};this.sifPlayer.param=this.sifPlayer.param||{};
(function(){var g=sifPlayer.param;g._set=function(e,a,b,d,f){var h;f||alert(JSON.stringify(f)+this.type+"  "+a);f.animated&&(h=f.animated._type);f._type&&(h=f._type);f._use?g._set(e,a,b,d,e.sifobj.sif.canvas.defs[f._use]):f.vector||"vector"===h?g.vector._get(e,a,b,d,f):f.integer||"integer"===h?g._getNumber(e,a,b,d,f,"integer"):f.real||"real"===h?g._getNumber(e,a,b,d,f,"real"):f.angle||"angle"===h?g._getNumber(e,a,b,d,f,"angle"):f.bool||"bool"===h?g.bool._get(e,a,b,d,f):f.color||"color"===h?g._getColor(e,
a,b,d,f):f.gradient||"gradient"===h?g._getGradient(e,a,b,d,f):f.composite?g.composite._get(e,a,b,d,f):f.bline_point?(d[a]={},d[a].composite={},f.bline_point.vertex?(g._set(e,"point","vector",d[a].composite,f.bline_point.vertex),g._set(e,"t1","vector",d[a].composite,f.bline_point.t1),d[a].composite.split={},d[a].composite.split.getValue=function(){return!1},g.convert._set(e,d[a].composite,b,"bline_point")):alert("not converted bline point")):f.scale||"scale"===h?(d[a]={},d[a].scale={},f.scale._link&&
(f.scale.link=e.sifobj.sif.canvas.defs[f.scale._link]),f.scale._scalar&&(f.scale.scalar=e.sifobj.sif.canvas.defs[f.scale._scalar]),g._set(e,"link",f.scale._type,d[a].scale,f.scale.link),g._set(e,"scalar","real",d[a].scale,f.scale.scalar),g.convert._set(e,d[a],b,"scale")):f.radial_composite||"radial_composite"===h?g._getRadial_composite(e,a,b,d,f):f.add?(h=f.add._type,d[a]={},d[a].add={},f.add._lhs&&(f.add.lhs=e.sifobj.sif.canvas.defs[f.add._lhs]),f.add._rhs&&(f.add.rhs=e.sifobj.sif.canvas.defs[f.add._rhs]),
f.add._scaler&&(f.add.scaler=e.sifobj.sif.canvas.defs[f.add._scaler]),g._set(e,"lhs",h,d[a].add,f.add.lhs),g._set(e,"rhs",h,d[a].add,f.add.rhs),g._set(e,"scalar","real",d[a].add,f.add.scalar),g.convert._set(e,d[a],b,"add")):f.and?(h=f.and._type,d[a]={},d[a].and={},g._set(e,"link1",h,d[a].and,f.and.link1),g._set(e,"link2",h,d[a].and,f.and.link2),g.convert._set(e,d[a],b,"and")):f.atan2?(h=f.atan2._type,d[a]={},d[a].atan2={},f.atan2._x&&(f.atan2.x=e.sifobj.sif.canvas.defs[f.atan2._x]),f.atan2._y&&(f.atan2.y=
e.sifobj.sif.canvas.defs[f.atan2._y]),g._set(e,"x","real",d[a].atan2,f.atan2.x),g._set(e,"y","real",d[a].atan2,f.atan2.y),g.convert._set(e,d[a],b,"atan2")):f.cos?(h=f.cos._type,d[a]={},d[a].cos={},f.cos._angle&&(f.cos.angle=e.sifobj.sif.canvas.defs[f.cos._angle]),f.cos._amp&&(f.cos.amp=e.sifobj.sif.canvas.defs[f.cos._amp]),g._set(e,"angle","angle",d[a].cos,f.cos.angle),g._set(e,"amp","real",d[a].cos,f.cos.amp),g.convert._set(e,d[a],b,"cos")):f.dotproduct?(h=f.dotproduct._type,d[a]={},d[a].dotproduct=
{},f.dotproduct._lhs&&(f.dotproduct.lhs=e.sifobj.sif.canvas.defs[f.dotproduct._lhs]),f.dotproduct._rhs&&(f.dotproduct.rhs=e.sifobj.sif.canvas.defs[f.dotproduct._rhs]),g._set(e,"lhs","vector",d[a].dotproduct,f.dotproduct.lhs),g._set(e,"rhs","vector",d[a].dotproduct,f.dotproduct.rhs),g.convert._set(e,d[a],b,"dotproduct")):f.exp?(h=f.exp._type,d[a]={},d[a].exp={},f.exp._exp&&(f.exp.exp=e.sifobj.sif.canvas.defs[f.exp._exp]),f.exp._scale&&(f.exp.scale=e.sifobj.sif.canvas.defs[f.exp._scale]),g._set(e,"exp",
"real",d[a].exp,f.exp.exp),g._set(e,"scale","real",d[a].exp,f.exp.scale),g.convert._set(e,d[a],b,"exp")):f.logarithm?(h=f.logarithm._type,d[a]={},d[a].logarithm={},f.logarithm._link&&(f.logarithm.link=e.sifobj.sif.canvas.defs[f.logarithm._link]),g._set(e,"link","real",d[a].logarithm,f.logarithm.link),g._set(e,"epsilon","real",d[a].logarithm,f.logarithm.epsilon),g._set(e,"infinite","real",d[a].logarithm,f.logarithm.infinite),g.convert._set(e,d[a],b,"logarithm")):f.reciprocal?(h=f.reciprocal._type,
d[a]={},d[a].reciprocal={},f.reciprocal._link&&(f.reciprocal.link=e.sifobj.sif.canvas.defs[f.reciprocal._link]),g._set(e,"link","real",d[a].reciprocal,f.reciprocal.link),g._set(e,"epsilon","real",d[a].reciprocal,f.reciprocal.epsilon),g._set(e,"infinite","real",d[a].reciprocal,f.reciprocal.infinite),g.convert._set(e,d[a],b,"reciprocal")):f.subtract?(h=f.subtract._type,d[a]={},d[a].subtract={},f.subtract._lhs&&(f.subtract.lhs=e.sifobj.sif.canvas.defs[f.subtract._lhs]),f.subtract._rhs&&(f.subtract.rhs=
e.sifobj.sif.canvas.defs[f.subtract._rhs]),f.subtract._scaler&&(f.subtract.scaler=e.sifobj.sif.canvas.defs[f.subtract._scaler]),g._set(e,"lhs",h,d[a].subtract,f.subtract.lhs),g._set(e,"rhs",h,d[a].subtract,f.subtract.rhs),g._set(e,"scalar","real",d[a].subtract,f.subtract.scalar),g.convert._set(e,d[a],b,"subtract")):f.sine?(h=f.sine._type,d[a]={},d[a].sine={},f.sine._angle&&(f.sine.angle=e.sifobj.sif.canvas.defs[f.sine._angle]),f.sine._amp&&(f.sine.amp=e.sifobj.sif.canvas.defs[f.sine._amp]),g._set(e,
"angle","angle",d[a].sine,f.sine.angle),g._set(e,"amp","real",d[a].sine,f.sine.amp),g.convert._set(e,d[a],b,"sine")):f.greyed?g._set(e,a,b,d,f.greyed.link):(alert("no param type"),alert(JSON.stringify(f)+" layer type : "+e.type))};g._getNumber=function(e,a,b,d,f,h){var i,j;i={paused:!0,useTick:!0};var k=e.sifobj.timeline,m;d[a]={};if(f.animated){f=f.animated.waypoint;d[a].value=f[0][h]._value;i=createjs.Tween.get(d[a],i);"0s"!==f[0]._time&&(m=sifPlayer._getEase(f[0]._before),j=sifPlayer._secsToMillis(f[0]._time),
i.to({value:f[0][h]._value},j,m));for(var l=0;l<f.length-1;l++)m=sifPlayer._getEase(f[l+1]._before),j=sifPlayer._secsToMillis(f[l+1]._time)-sifPlayer._secsToMillis(f[l]._time),f[l][h]._value!==f[l+1][h]._value?i.to({value:f[l+1][h]._value},j,m):i.wait(j);k.addTween(i)}else f[h]||alert(JSON.stringify(f)+"param_type : "+h+" param_name : "+a+" layer type : "+this.type),d[a].value=f[h]._value;g.convert._set(e,d[a],b,h)};g._getRadial_composite=function(e,a,b,d,f){param_type="radial_composite";d[a]={};
d[a]._type=param_type;d[a].radial_composite={};f[param_type]._radius&&(f[param_type].radius=e.sifobj.sif.canvas.defs[f[param_type]._radius]);f[param_type]._theta&&(f[param_type].theta=e.sifobj.sif.canvas.defs[f[param_type]._theta]);g._set(e,"radius","real",d[a][param_type],f[param_type].radius);g._set(e,"theta","angle",d[a][param_type],f[param_type].theta);g.convert._set(e,d[a],b,param_type)};g._getColor=function(e,a,b,d,f){b={paused:!0,useTick:!0};e=e.sifobj.timeline;d[a]={};d[a].animated=!0;if(f.animated){w=
f.animated.waypoint;d[a].r=w[0].color.r;d[a].g=w[0].color.g;d[a].b=w[0].color.b;d[a].a=w[0].color.a;tw=createjs.Tween.get(d[a],b);"0s"!==w[0]._time&&tw.to({r:w[0].color.r,g:w[0].color.g,b:w[0].color.b,a:w[0].color.a},sifPlayer._secsToMillis(w[0]._time),sifPlayer._getEase(w[0]._before));for(a=0;a<w.length-1;a++)tw.to({r:w[a+1].color.r,g:w[a+1].color.g,b:w[a+1].color.b,a:w[a+1].color.a},sifPlayer._secsToMillis(w[a+1]._time)-sifPlayer._secsToMillis(w[a]._time),sifPlayer._getEase(w[a+1]._before));e.addTween(tw)}else d[a].r=
f.color.r,d[a].g=f.color.g,d[a].b=f.color.b,d[a].a=f.color.a};g._getGradient=function(e,a,b,d,f,g){g="gradient";b={paused:!0,useTick:!0};e=e.sifobj.timeline;d[a]={};var i;if(f.animated){w=f.animated.waypoint;d[g]={};d[g].color=[];for(var j=0,k=w[0].gradient.color.length;j<k;j++){d[g].color.push({});i=d[g].color[j];a=w[0].gradient.color[j];i.pos=a._pos;i.r=a.r;i.g=a.g;i.b=a.b;i.a=a.a;tw=createjs.Tween.get(i,b);"0s"!==w[0]._time&&tw.to({pos:a._pos,r:a.r,g:a.g,b:a.b,a:a.a},sifPlayer._secsToMillis(w[0]._time),
sifPlayer._getEase(w[0]._before));f=0;for(i=w.length-1;f<i;f++)a=w[f+1].gradient.color[j],tw.to({pos:a._pos,r:a.r,g:a.g,b:a.b,a:a.a},sifPlayer._secsToMillis(w[f+1]._time)-sifPlayer._secsToMillis(w[f]._time),sifPlayer._getEase(w[f+1]._before));e.addTween(tw)}}else{d[g]={};d[g].color=[];j=0;for(k=f[g].color.length;j<k;j++)d[g].color.push({}),i=d[g].color[j],a=f[g].color[j],i.pos=a._pos,i.r=a.r,i.g=a.g,i.b=a.b,i.a=a.a}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){sifPlayer.param.vector={_get:function(g,e,a,b,d){var f,h;f={paused:!0,useTick:!0};var i=g.sifobj.timeline;b[e]={};if(d.animated){d=d.animated.waypoint;b[e].x=d[0].vector.x;b[e].y=d[0].vector.y;f=createjs.Tween.get(b[e],f);"0s"!==d[0]._time&&(h=sifPlayer._secsToMillis(d[0]._time),f.to({x:d[0].vector.x,y:d[0].vector.y},h,sifPlayer._getEase(d[0]._before)));for(var j=0;j<d.length-1;j++)h=sifPlayer._secsToMillis(d[j+1]._time)-sifPlayer._secsToMillis(d[j]._time),f.to({x:d[j+1].vector.x,y:d[j+
1].vector.y},h,sifPlayer._getEase(d[j+1]._before));i.addTween(f);sifPlayer.param.convert._set(g,b[e],a,"vector")}else d.vector?(b[e].x=d.vector.x,b[e].y=d.vector.y,sifPlayer.param.convert._set(g,b[e],a,"vector",!1)):alert(JSON.stringify(d)+" in vector")},_setConvert:function(g,e,a,b){g=sifPlayer.param.vector;a===b?(e.getX=g.getX,e.getY=g.getY):"radial_composite"===b?(e.getX=g.getRadialX,e.getY=g.getRadialY):"composite"===b?(e.getX=g.getCompositeX,e.getY=g.getCompositeY):"add"===b?(e.getX=g.getAddX,
e.getY=g.getAddY):"scale"===b?e.scale.composite?(e.getX=g.getScaleCompositeX,e.getY=g.getScaleCompositeY):e.scale.radial_composite?(e.getX=g.getScaleRadialX,e.getY=g.getScaleRadialY):(e.getX=g.getScaleX,e.getY=g.getScaleY):"subtract"===b&&(e.getX=g.getSubX,e.getY=g.getSubY)},getX:function(){return this.x},getY:function(){return this.y},getScaleX:function(){return this.scale.link.getX()*this.scale.scalar.getValue()},getScaleY:function(){return this.scale.link.getY()*this.scale.scalar.getValue()},getScaleCompositeX:function(){return this.scale.composite.x.getValue()*
this.scalar.getValue()},getScaleCompositeY:function(){return this.scale.composite.y.getValue()*this.scalar.getValue()},getScaleRadialX:function(){var g=this.scale.radial_composite.theta.getValue()*Math.PI/180,e=this.scale.radial_composite.radius.getValue();return Math.cos(g)*e*this.scalar.getValue()},getScaleRadialY:function(){var g=this.scale.radial_composite.theta.getValue()*Math.PI/180,e=this.scale.radial_composite.radius.getValue();return Math.sin(g)*e*this.scalar.getValue()},getRadialX:function(){var g=
this.radial_composite.theta.getValue()*Math.PI/180,e=this.radial_composite.radius.getValue();return Math.cos(g)*e},getRadialY:function(){var g=this.radial_composite.theta.getValue()*Math.PI/180,e=this.radial_composite.radius.getValue();return Math.sin(g)*e},getCompositeX:function(){return this.composite.x.getValue()},getCompositeY:function(){return this.composite.y.getValue()},getAddX:function(){return(this.add.lhs.getX()+this.add.rhs.getX())*this.add.scalar.getValue()},getAddY:function(){return(this.add.lhs.getY()+
this.add.rhs.getY())*this.add.scalar.getValue()},getSubX:function(){return(this.subtract.lhs.getX()-this.subtract.rhs.getX())*this.subtract.scalar.getValue()},getSubY:function(){return(this.subtract.lhs.getY()-this.subtract.rhs.getY())*this.subtract.scalar.getValue()}}})();this.sifPlayer.param=this.sifPlayer.param||{};(function(){sifPlayer.param.integer={_setConvert:function(g,e,a,b){g=sifPlayer.param.integer;a===b?e.getValue=g.getValue:g[b]?e.getValue=g[b]:alert("no convert for integer to "+b)},getValue:function(){return this.value},add:function(){return(this.add.lhs.getValue()+this.add.rhs.getValue())*this.add.scalar.getValue()},scale:function(){return this.scale.link.getValue()*this.scale.scalar.getValue()}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){var g={degsToRad:0.0174532925,_setConvert:function(e,a,b,d){e=sifPlayer.param.real;b===d?a.getValue=e.getValue:e[d]?a.getValue=e[d]:alert("no convert for real to "+d)},getValue:function(){return this.value},add:function(){return(this.add.lhs.getValue()+this.add.rhs.getValue())*this.add.scalar.getValue()},subtract:function(){return(this.subtract.lhs.getValue()-this.subtract.rhs.getValue())*this.subtract.scalar.getValue()},scale:function(){return this.scale.link.getValue()*this.scale.scalar.getValue()},
cos:function(){return this.cos.amp.getValue()*Math.cos(this.cos.angle.getValue()*g.degsToRad)},sine:function(){return this.sine.amp.getValue()*Math.sin(this.sine.angle.getValue()*g.degsToRad)},dotproduct:function(){var e,a,b,d;e=this.dotproduct.lhs.getX();a=this.dotproduct.lhs.getY();b=this.dotproduct.rhs.getX();d=this.dotproduct.rhs.getY();return e*b+a*d},exp:function(){return Math.exp(this.exp.exp.getValue())*this.exp.scale.getValue()},logarithm:function(){var e=this.logarithm.link.getValue();return e>=
this.logarithm.epsilon.getValue()?Math.log(e):-this.logarithm.infinite.getValue()},reciprocal:function(){var e=this.reciprocal.link.getValue();return e>=this.reciprocal.epsilon.getValue()?1/e:-this.reciprocal.infinite.getValue()}};sifPlayer.param.real=g})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){sifPlayer.param.angle={_setConvert:function(g,e,a,b){g=sifPlayer.param.angle;a===b?e.getValue=g.getValue:g[b]?e.getValue=g[b]:alert("no convert for angle to "+b)},getValue:function(){return this.value},add:function(){return(this.add.lhs.getValue()+this.add.rhs.getValue())*this.add.scalar.getValue()},subtract:function(){return(this.subtract.lhs.getValue()-this.subtract.rhs.getValue())*this.subtract.scalar.getValue()},scale:function(){return this.scale.link.getValue()*this.scale.scalar.getValue()},
atan2:function(){return 180*(Math.atan2(this.atan2.y.getValue(),this.atan2.x.getValue())/Math.PI)},dotproduct:function(){var g,e,a,b;g=this.dotproduct.lhs.getX();e=this.dotproduct.lhs.getY();a=this.dotproduct.rhs.getX();b=this.dotproduct.rhs.getY();return 180*(Math.acos((g*a+e*b)/(Math.sqrt(g*g+e*e)*Math.sqrt(a*a+b*b)))/Math.PI)}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){sifPlayer.param.bool={_get:function(g,e,a,b,d){var f=sifPlayer.param,h,i;h={paused:!0,useTick:!0};var j=g.sifobj.timeline,k,m=0,l=[0,1];b[e]={};if(d.animated){d=d.animated.waypoint;b[e].value=d[0].bool._value;h=createjs.Tween.get(b[e],h);"0s"!==d[0]._time&&(k=sifPlayer.Ease.bool,i=sifPlayer._secsToMillis(d[0]._time),h.to({value:d[0].bool._value},i,k));for(var n=0;n<d.length-1;n++)k=l[1-m]?sifPlayer.Ease.bool:sifPlayer.Ease.constant,m=1-m,i=sifPlayer._secsToMillis(d[n+1]._time)-sifPlayer._secsToMillis(d[n]._time),
d[n].bool._value!==d[n+1].bool._value?h.to({value:d[n+1].bool._value},i,k):h.wait(i);j.addTween(h)}else d.bool||alert(JSON.stringify(d)+"param_type : bool param_name : "+e+" layer type : "+this.type),b[e].value=d.bool._value;f.convert._set(g,b[e],a,"bool")},_setConvert:function(g,e,a,b){g=sifPlayer.param.bool;a===b?e.getValue=g.getValue:"and"===b&&(e.getValue=g.getAnd)},getValue:function(){return this.value},getAnd:function(){return this.link1&&this.link2}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){var g={_get:function(e,a,b,d,f){var g=sifPlayer.param,i=g._set,j="composite";d[a]={};d[a]._type=j;d[a].composite={};if("vector"===f.composite._type)f[j]._x&&(f[j].x=e.sifobj.sif.canvas.defs[f[j]._x]),f[j]._y&&(f[j].y=e.sifobj.sif.canvas.defs[f[j]._y]),i(e,"x","real",d[a].composite,f.composite.x),i(e,"y","real",d[a].composite,f.composite.y),g.convert._set(e,d[a],b,j);else if("bline_point"===f.composite._type){var k=d[a].composite,j=f.composite._type;i(e,"point","vector",k,f.composite.point);
i(e,"width","real",k,f.composite.width);i(e,"origin","real",k,f.composite.origin);i(e,"split","bool",k,f.composite.split);i(e,"t1","vector",k,f.composite.t1);i(e,"t2","vector",k,f.composite.t2);g.convert._set(e,d[a].composite,b,j,f.composite.point.animated||f.composite.width.animated||f.composite.origin.animated||f.composite.t1.animated||f.composite.t2.animated)}},_setConvert:function(e,a,b,d){"bline_point"===d?(a.getPoint=g.getPoint,a.getT1=g.bline_point_getT1,a.getT2=g.bline_point_getT2):alert("new type of point")},
getPoint:function(){return this.point},bline_point_getPoint:function(){return this.point},bline_point_getT1:function(){return{x:this.t1.getX()/3,y:this.t1.getY()/3}},bline_point_getT2:function(){return{x:this.t2.getX()/3,y:this.t2.getY()/3}}};sifPlayer.param.composite=g})();this.sifPlayer.param=this.sifPlayer.param||{};this.sifPlayer.param.convert=this.sifPlayer.param.convert||{};(function(){sifPlayer.param.convert._set=function(g,e,a,b){"vector"===a?sifPlayer.param[a]._setConvert(g,e,a,b):"real"===a?sifPlayer.param[a]._setConvert(g,e,a,b):"integer"===a?sifPlayer.param[a]._setConvert(g,e,a,b):"angle"===a?sifPlayer.param[a]._setConvert(g,e,a,b):"bool"===a?sifPlayer.param[a]._setConvert(g,e,a,b):"composite"===a&&sifPlayer.param[a]._setConvert(g,e,a,b)}})();(function(){function g(){}var e=g.prototype;e.parent=null;e.sifobj=null;e.type=null;e.initLayer=function(a,b){a.hasOwnProperty("sifPath")?this.sifobj=a:(this.parent=a,this.sifobj=a.sifobj);this.type=b._type;b._desc&&(this.desc=b._desc,this.sifobj.desc[this.desc]=this)};e.draw=function(){};e._getBlend=function(){switch(this.blend_method.getValue()){case 0:return"source-over";case 1:return"copy";case 13:return"source-atop";case 21:return"source-in";case 12:return"destination-over";case 19:return"destination-out";
case 14:return"destination-in";default:return"source-over"}};e._getTotalAmount=function(){var a=this.amount.getValue(),b=this.parent;return b?b._getTotalAmount()*a:a};sifPlayer.Layer=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"blend_method","integer",this,b.blend_method);d(this,"amount","real",this,b.amount);d(this,"origin","vector",this,b.origin);d(this,"color","color",this,b.color);this._getBline(b.bline)};e.draw=function(a){var b,d,f=a.ctx;f.fillStyle="rgba("+Math.round(256*this.color.r)+", "+Math.round(256*this.color.g)+", "+Math.round(256*this.color.b)+", "+this.color.a+
")";f.globalAlpha=this._getTotalAmount();a.save();a.translate(this.origin.getX(),this.origin.getY());f.globalCompositeOperation=this._getBlend();f.beginPath();b=this.bline.entry[0].composite.getPoint();f.moveTo(b.getX(),b.getY());for(var e=0;e<this.bline.entry.length-1;e++)b=this.bline.entry[e].composite,d=this.bline.entry[e+1].composite,b.split.getValue()?this._bezierPart(f,b.getPoint(),d.getPoint(),b.getT2(),d.getT1()):this._bezierPart(f,b.getPoint(),d.getPoint(),b.getT1(),d.getT1());this.bline.loop&&
(b=this.bline.entry[this.bline.entry.length-1].composite,d=this.bline.entry[0].composite,b.split.getValue()?this._bezierPart(f,b.getPoint(),d.getPoint(),b.getT2(),d.getT1()):this._bezierPart(f,b.getPoint(),d.getPoint(),b.getT1(),d.getT1()));f.closePath();f.fill();a.restore()};e._getBline=function(a){var b=sifPlayer.param._set;this.bline={};this.bline.entry=[];this.bline.loop=a.bline._loop;for(var d=0,f=a.bline.entry.length;d<f;d++){var e={};b(this,"composite","composite",e,a.bline.entry[d]);this.bline.entry.push(e.composite)}};
e._bezierPart=function(a,b,d,f,e){var g;g=f.x+b.getX();b=f.y+b.getY();f=-e.x+d.getX();e=-e.y+d.getY();a.bezierCurveTo(g,b,f,e,d.getX(),d.getY())};sifPlayer.region=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"blend_method","integer",this,b.blend_method);d(this,"amount","real",this,b.amount);d(this,"width","real",this,b.width);d(this,"origin","vector",this,b.origin);d(this,"color","color",this,b.color);this._getBline(b.bline)};e.draw=function(a){var b=a.ctx,d,f;b.fillStyle="rgba("+Math.round(256*this.color.r)+", "+Math.round(256*this.color.g)+", "+
Math.round(256*this.color.b)+", "+this.color.a+")";b.globalAlpha=this._getTotalAmount();a.save();a.translate(this.origin.getX(),this.origin.getY());b.globalCompositeOperation=this._getBlend();b.beginPath();d=this.bline.entry[0].composite.getPoint();b.moveTo(d.getX(),d.getY());for(var e=0;e<this.bline.entry.length-1;e++)d=this.bline.entry[e].composite,f=this.bline.entry[e+1].composite,d.split.getValue()?this._bezierPart(b,d.getPoint(),f.getPoint(),d.getT2(),f.getT1()):this._bezierPart(b,d.getPoint(),
f.getPoint(),d.getT1(),f.getT1());this.bline.loop&&(d=this.bline.entry[this.bline.entry.length-1].composite,f=this.bline.entry[0].composite,d.split.getValue()?this._bezierPart(b,d.getPoint(),f.getPoint(),d.getT2(),f.getT1()):this._bezierPart(b,d.getPoint(),f.getPoint(),d.getT1(),f.getT1()));b.lineWidth=this.width.getValue();b.stroke();a.restore()};e._getBline=function(a){var b=sifPlayer.param._set;this.bline={};this.bline.entry=[];this.bline.loop=a.bline._loop;for(var d=0,e=a.bline.entry.length;d<
e;d++){var g={};b(this,"composite","composite",g,a.bline.entry[d]);this.bline.entry.push(g.composite)}};e._bezierPart=function(a,b,d,e,g){var i;i=e.x+b.getX();b=e.y+b.getY();e=-g.x+d.getX();g=-g.y+d.getY();a.bezierCurveTo(i,b,e,g,d.getX(),d.getY())};sifPlayer.outline=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"origin","vector",this,b.origin);d(this,"radius","real",this,b.radius);d(this,"blend_method","integer",this,b.blend_method);d(this,"color","color",this,b.color)};e.draw=function(a){var b=this.origin,a=a.ctx;a.fillStyle="rgba("+Math.round(256*this.color.r)+", "+Math.round(256*this.color.g)+", "+Math.round(256*
this.color.b)+", "+this.color.a+")";a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();a.beginPath();a.arc(b.getX(),b.getY(),this.radius.getValue(),0,2*Math.PI,!1);a.closePath();a.fill()};sifPlayer.circle=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"tl","vector",this,b.tl);d(this,"br","vector",this,b.br);this.image=new Image;this.image.src=this.sifobj.sifPath+b.filename.string};e.draw=function(a){var b=a.ctx;a.save();b.globalAlpha=this._getTotalAmount();b.globalCompositeOperation=this._getBlend();this._drawImage(b);
a.restore()};e._drawImage=function(a){var b=this.br.getX()-this.tl.getX(),d=this.tl.getY()-this.br.getY(),e,g;0>=b?(e=-1,b*=-1):e=1;0>=d?(g=1,d*=-1):g=-1;a.translate(this.tl.getX(),this.tl.getY());a.scale(e,g);a.drawImage(this.image,0,0,b,d)};sifPlayer.Import=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"p1","vector",this,b.p1);d(this,"p2","vector",this,b.p2);d(this,"gradient","gradient",this,b.gradient)};e.draw=function(a){for(var a=a.ctx,b=a.createLinearGradient(this.p1.getX(),this.p1.getY(),this.p2.getX(),this.p2.getY()),d=this.gradient.color,e=0,g=d.length;e<
g;e++)b.addColorStop(d[e].pos,"rgba("+Math.round(256*d[e].r)+", "+Math.round(256*d[e].g)+", "+Math.round(256*d[e].b)+", "+d[e].a+")");a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();a.fillStyle=b;a.fillRect(-1E3,-1E3,2E3,2E3)};sifPlayer.linear_gradient=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"origin","vector",this,b.origin);d(this,"zoom","real",this,b.zoom);d(this,"focus","vector",this,b.focus);this._getLayers(b.canvas.canvas.layer);this.dCanvas=document.createElement("canvas")};e._getLayers=function(a){this.layer=[];for(var b=0;b<a.length;b++)this.layer.push(sifPlayer._getLayer(this,
a[b]))};e.draw=function(a){var b=Math.exp(this.zoom.getValue()),d=this.layer,e=this.focus,g=this.origin;this.dCanvas.height=0;this.dCanvas.height=this.sifobj.height;this.dCanvas.width=this.sifobj.width;var i=new sifPlayer.Tracker(this.dCanvas.getContext("2d"));a.save();a.translate(e.getX(),e.getY());a.scale(b,b);a.translate(-e.getX(),-e.getY());a.translate(g.getX()/b,g.getY()/b);i.setMatrix(a.getMatrix());b=0;for(e=d.length;b<e;b++)d[b].draw(i);a.setMatrix([1,0,0,1,0,0]);a.ctx.globalCompositeOperation=
this._getBlend();a.ctx.globalAlpha=this._getTotalAmount();a.ctx.drawImage(i.ctx.canvas,0,0);console.log(this.origin.getY());a.restore()};sifPlayer.PasteCanvas=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"center","vector",this,b.center);d(this,"radius","real",this,b.radius);d(this,"gradient","gradient",this,b.gradient)};e.draw=function(a){for(var a=a.ctx,b=this.center.getX(),d=this.center.getY(),b=a.createRadialGradient(b,d,0,b,d,this.radius.getValue()),
d=this.gradient.color,e=0,g=d.length;e<g;e++)b.addColorStop(d[e].pos,"rgba("+Math.round(256*d[e].r)+", "+Math.round(256*d[e].g)+", "+Math.round(256*d[e].b)+", "+d[e].a+")");a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();a.fillStyle=b;a.fillRect(-1E3,-1E3,2E3,2E3)};sifPlayer.radial_gradient=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){this.initLayer(a,b)};e.draw=function(a){a.restore()};sifPlayer.restore=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"origin","vector",this,b.origin);d(this,"amount","angle",this,b.amount)};e.draw=function(a){a.save();a.translate(this.origin.getX(),this.origin.getY());a.rotate(this.amount.value*Math.PI/180);a.translate(-this.origin.getX(),-this.origin.getY())};sifPlayer.rotate=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","vector",this,b.amount);d(this,"center","vector",this,b.center)};e.draw=function(a){var b=this.center,d=this.amount;a.save();a.translate(b.getX(),b.getY());a.scale(d.getX(),d.getY());a.translate(-b.getX(),-b.getY())};sifPlayer.stretch=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"origin","vector",this,b.origin)};e.draw=function(a){var b=this.origin;a.save();a.translate(b.getX(),b.getY())};sifPlayer.translate=g})();(function(){function g(a,b){this.init(a,b)}var e=g.prototype=new sifPlayer.Layer;e.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"center","vector",this,b.center);d(this,"amount","real",this,b.amount)};e.draw=function(a){var b=Math.exp(this.amount.getValue()),d=this.center;a.save();a.translate(d.getX(),d.getY());a.scale(b,b);a.translate(-d.getX()/b,-d.getY()/b)};sifPlayer.zoom=g})();
