/*
 Copyright (c) 2012 haramanai.
 sifPlayer
 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
*/
this.sifPlayer=this.sifPlayer||{};
(function(){sifPlayer._getData=function(e){function f(b,d){a[b]?(a[b].constructor!=Array&&(a[b]=[a[b]]),a[b][a[b].length]=d):a[b]=d}var a={},b,d,g;for(b=0;d=e.attributes[b];b++)f("_"+d.name,sifPlayer._toSifValue(d.value));for(b=0;d=e.childNodes[b];b++)if(1==d.nodeType)if(g=d.nodeName,1==d.childNodes.length&&3==d.firstChild.nodeType)f(d.nodeName,sifPlayer._toSifValue(d.firstChild.nodeValue));else switch(g){case "param":a[d.getAttribute("name")]=sifPlayer._getData(d);break;case "layer":"undefined"==
typeof a[g]&&(a[g]=[]);switch(d.getAttribute("type")){case "rotate":case "translate":case "zoom":case "stretch":f("layer",{_type:"restore"});a.layer.unshift(sifPlayer._getData(d));break;default:f(d.nodeName,sifPlayer._getData(d))}break;case "waypoint":"undefined"==typeof a[g]&&(a[g]=[]);default:f(g,sifPlayer._getData(d))}return a};sifPlayer._secsToMillis=function(e){return 1E3*parseFloat(e.replace("s",""))};sifPlayer._canvasTimeToMillis=function(e,f){var a=0,b;0<e.search("h")&&(b=e.split("h"),a+=
36E5*b[0],e=b[1]);0<e.search("m")&&(b=e.split("m"),a+=6E4*b[0],e=b[1]);0<e.search("s")&&(b=e.split("s"),a+=1E3*b[0],e=b[1]);0<e.search("f")&&(b=e.split("f"),a+=1E3*b[0]/f);return a};sifPlayer._getLayer=function(e,f){if(sifPlayer[f._type])return new sifPlayer[f._type](e,f);if("import"===f._type)return new sifPlayer.Import(e,f);console.log("EERRROOR  "+f._type+" layer it's not supported");var a=new sifPlayer.Layer;a.initLayer(e,f);return a};sifPlayer._toSifValue=function(e){var f=Number(e);return!isNaN(f)?
f:"true"===e?!0:"false"===e?!1:":"===e[0]?e.substr(1):e};sifPlayer._getEase=function(e){return"linear"===e?createjs.Ease.linear:"clamped"===e||"halt"===e?createjs.Ease.none:"constant"===e?sifPlayer.Ease.constant:"auto"===e?createjs.Ease.none:!1};window.sifPlayer=sifPlayer})();(function(){Ease={constant:function(e){return 1>e?0:1},bool:function(e){return 1>e?1:0}};sifPlayer.Ease=Ease})();(function(){function e(a,b){if(b)for(c in b)this[c]=b[c];this.sifPath=this.sifPath||"";this.init(a);this.canvas=document.createElement("canvas")}var f=e.prototype;f.x=0;f.y=0;f.width=320;f.height=240;f.sifPath="";f.timeline=null;f.desc={};f.init=function(a){a=sifPlayer._getData(a.getElementsByTagName("canvas")[0]);this.timeline=new createjs.Timeline;this.timeline.setPaused(!0);this._getCanvasData(a)};f.draw=function(a){var b=this.sif.canvas,d=this.sif.canvas.layer,f=b.bgcolor;a.clearRect(this.x,this.y,
this.width,this.height);a.beginPath();a.rect(this.x,this.y,this.width,this.height);a.closePath();a.clip();a.save();a.setTransform(this.width/(b.view_box[2]-b.view_box[0]),0,0,this.height/(b.view_box[3]-b.view_box[1]),this.x+this.width/2,this.y+this.height/2);for(b=0;b<d.length;b++)d[b].draw(a);a.restore();a.globalAlpha=1;a.globalCompositeOperation="destination-over";a.fillStyle="rgba("+f.r+", "+f.g+", "+f.b+", "+f.a+")";a.fillRect(this.x,this.y,this.width,this.height)};f._getCanvasData=function(a){this.sif=
{};this.sif.canvas={};this.sif.canvas.version=a._version;this.sif.canvas.width=a._width;this.sif.canvas.height=a._height;var b=a["_view-box"].split(" ");this.sif.canvas.view_box=[parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2]),parseFloat(b[3])];this.sif.canvas.antialias=a._antialias;this.sif.canvas.fps=a._fps;this.sif.canvas.begin_time=sifPlayer._canvasTimeToMillis(a["_begin-time"],this.sif.canvas.fps);this.sif.canvas.end_time=sifPlayer._canvasTimeToMillis(a["_end-time"],this.sif.canvas.fps);b=
a._bgcolor.split(" ");this.sif.canvas.bgcolor={};this.sif.canvas.bgcolor.r=Math.round(256*parseFloat(b[0]));this.sif.canvas.bgcolor.g=Math.round(256*parseFloat(b[1]));this.sif.canvas.bgcolor.b=Math.round(256*parseFloat(b[2]));this.sif.canvas.bgcolor.a=parseFloat(b[3]);this.sif.canvas.name=a.name;this.sif.canvas.defs=this._getDefs(a.defs);this.sif.canvas.layer=[];this.timeline.duration=this.sif.canvas.end_time;for(b=0;b<a.layer.length;b++)this.sif.canvas.layer.push(sifPlayer._getLayer(this,a.layer[b]))};
f._getDefs=function(a){var b={};for(name in a)if(a[name].constructor!=Array)"animated"===name?(b[a[name]._id]={},b[a[name]._id].animated=a[name]):(b[a[name]._id]={},b[a[name]._id][name]=a[name],b[a[name]._id]._type=name);else for(var d=0;d<a[name].length;d++)"animated"===name?(b[a[name][d]._id]={},b[a[name][d]._id].animated=a[name][d]):(b[a[name][d]._id]={},b[a[name][d]._id][name]=a[name][d],b[a[name][d]._id]._type=name);return b};sifPlayer.SifObject=e})();this.sifPlayer=this.sifPlayer||{};this.sifPlayer.param=this.sifPlayer.param||{};
(function(){var e=sifPlayer.param;e._set=function(f,a,b,d,g){var h;g||alert(JSON.stringify(g)+this.type+"  "+a);g.animated&&(h=g.animated._type);g._type&&(h=g._type);g._use?e._set(f,a,b,d,f.sifobj.sif.canvas.defs[g._use]):g.vector||"vector"===h?e.vector._get(f,a,b,d,g):g.integer||"integer"===h?e._getNumber(f,a,b,d,g,"integer"):g.real||"real"===h?e._getNumber(f,a,b,d,g,"real"):g.angle||"angle"===h?e._getNumber(f,a,b,d,g,"angle"):g.bool||"bool"===h?e.bool._get(f,a,b,d,g):g.color||"color"===h?e._getColor(f,
a,b,d,g):g.gradient||"gradient"===h?e._getGradient(f,a,b,d,g):g.composite?e.composite._get(f,a,b,d,g):g.scale||"scale"===h?(d[a]={},e._set(f,"scale",g.scale.link._type,d[a],g.scale.link),e._set(f,"scalar","real",d[a],g.scale.scalar),e.convert._set(f,d[a],b,"scale")):g.radial_composite||"radial_composite"===h?e._getRadial_composite(f,a,b,d,g):g.add?(h=g.add._type,d[a]={},d[a].add={},e._set(f,"lhs",h,d[a].add,g.add.lhs),e._set(f,"rhs",h,d[a].add,g.add.rhs),e._set(f,"scalar","real",d[a].add,g.add.scalar),
e.convert._set(f,d[a],b,"add")):g.and?(h=g.and._type,d[a]={},d[a].and={},e._set(f,"link1",h,d[a].and,g.and.link1),e._set(f,"link2",h,d[a].and,g.and.link2),e.convert._set(f,d[a],b,"and")):g.greyed?e._set(f,a,b,d,g.greyed.link):(alert("no param type"),alert(JSON.stringify(g)+" layer type : "+f.type))};e._getNumber=function(f,a,b,d,g,h){var i,j;i={paused:!0,useTick:!0};var k=f.sifobj.timeline,m;d[a]={};if(g.animated){g=g.animated.waypoint;d[a].value=g[0][h]._value;i=createjs.Tween.get(d[a],i);"0s"!==
g[0]._time&&(m=sifPlayer._getEase(g[0]._before),j=sifPlayer._secsToMillis(g[0]._time),i.to({value:g[0][h]._value},j,m));for(var l=0;l<g.length-1;l++)m=sifPlayer._getEase(g[l+1]._before),j=sifPlayer._secsToMillis(g[l+1]._time)-sifPlayer._secsToMillis(g[l]._time),g[l][h]._value!==g[l+1][h]._value?i.to({value:g[l+1][h]._value},j,m):i.wait(j);k.addTween(i)}else g[h]||alert(JSON.stringify(g)+"param_type : "+h+" param_name : "+a+" layer type : "+this.type),d[a].value=g[h]._value;e.convert._set(f,d[a],b,
h)};e._getRadial_composite=function(f,a,b,d,g){param_type="radial_composite";d[a]={};d[a]._type=param_type;d[a].radial_composite={};g[param_type]._radius&&(g[param_type].radius=f.sifobj.sif.canvas.defs[g[param_type]._radius]);g[param_type]._theta&&(g[param_type].theta=f.sifobj.sif.canvas.defs[g[param_type]._theta]);e._set(f,"radius","real",d[a][param_type],g[param_type].radius);e._set(f,"theta","angle",d[a][param_type],g[param_type].theta);e.convert._set(f,d[a],b,param_type)};e._getColor=function(f,
a,b,d,g){b={paused:!0,useTick:!0};f=f.sifobj.timeline;d[a]={};d[a].animated=!0;if(g.animated){w=g.animated.waypoint;d[a].r=w[0].color.r;d[a].g=w[0].color.g;d[a].b=w[0].color.b;d[a].a=w[0].color.a;tw=createjs.Tween.get(d[a],b);"0s"!==w[0]._time&&tw.to({r:w[0].color.r,g:w[0].color.g,b:w[0].color.b,a:w[0].color.a},sifPlayer._secsToMillis(w[0]._time),sifPlayer._getEase(w[0]._before));for(a=0;a<w.length-1;a++)tw.to({r:w[a+1].color.r,g:w[a+1].color.g,b:w[a+1].color.b,a:w[a+1].color.a},sifPlayer._secsToMillis(w[a+
1]._time)-sifPlayer._secsToMillis(w[a]._time),sifPlayer._getEase(w[a+1]._before));f.addTween(tw)}else d[a].r=g.color.r,d[a].g=g.color.g,d[a].b=g.color.b,d[a].a=g.color.a};e._getGradient=function(f,a,b,d,g,e){e="gradient";b={paused:!0,useTick:!0};f=f.sifobj.timeline;d[a]={};var i;if(g.animated){w=g.animated.waypoint;d[e]={};d[e].color=[];for(var j=0,k=w[0].gradient.color.length;j<k;j++){d[e].color.push({});i=d[e].color[j];a=w[0].gradient.color[j];i.pos=a._pos;i.r=a.r;i.g=a.g;i.b=a.b;i.a=a.a;tw=createjs.Tween.get(i,
b);"0s"!==w[0]._time&&tw.to({pos:a._pos,r:a.r,g:a.g,b:a.b,a:a.a},sifPlayer._secsToMillis(w[0]._time),sifPlayer._getEase(w[0]._before));g=0;for(i=w.length-1;g<i;g++)a=w[g+1].gradient.color[j],tw.to({pos:a._pos,r:a.r,g:a.g,b:a.b,a:a.a},sifPlayer._secsToMillis(w[g+1]._time)-sifPlayer._secsToMillis(w[g]._time),sifPlayer._getEase(w[g+1]._before));f.addTween(tw)}}else{d[e]={};d[e].color=[];j=0;for(k=g[e].color.length;j<k;j++)d[e].color.push({}),i=d[e].color[j],a=g[e].color[j],i.pos=a._pos,i.r=a.r,i.g=a.g,
i.b=a.b,i.a=a.a}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){sifPlayer.param.vector={_get:function(e,f,a,b,d){var g,h;g={paused:!0,useTick:!0};var i=e.sifobj.timeline;b[f]={};if(d.animated){d=d.animated.waypoint;b[f].x=d[0].vector.x;b[f].y=d[0].vector.y;g=createjs.Tween.get(b[f],g);"0s"!==d[0]._time&&(h=sifPlayer._secsToMillis(d[0]._time),g.to({x:d[0].vector.x,y:d[0].vector.y},h,sifPlayer._getEase(d[0]._before)));for(var j=0;j<d.length-1;j++)h=sifPlayer._secsToMillis(d[j+1]._time)-sifPlayer._secsToMillis(d[j]._time),d[j].vector.x!==d[j+1].vector.x&&
d[j].vector.y!==d[j+1].vector.y?g.to({x:d[j+1].vector.x,y:d[j+1].vector.y},h,sifPlayer._getEase(d[j+1]._before)):g.wait(h);i.addTween(g);sifPlayer.param.convert._set(e,b[f],a,"vector")}else d.vector?(b[f].x=d.vector.x,b[f].y=d.vector.y,sifPlayer.param.convert._set(e,b[f],a,"vector",!1)):alert(JSON.stringify(d)+" in vector")},_setConvert:function(e,f,a,b){e=sifPlayer.param.vector;a===b?(f.getX=e.getX,f.getY=e.getY):"radial_composite"===b?(f.getX=e.getRadialX,f.getY=e.getRadialY):"composite"===b?(f.getX=
e.getCompositeX,f.getY=e.getCompositeY):"add"===b?(f.getX=e.getAddX,f.getY=e.getAddY):"scale"===b&&(f.scale.composite?(f.getX=e.getScaleCompositeX,f.getY=e.getScaleCompositeY):f.scale.radial_composite&&(f.getX=e.getScaleRadialX,f.getY=e.getScaleRadialY))},getX:function(){return this.x},getY:function(){return this.y},getScaleCompositeX:function(){return this.scale.composite.x.getValue()*this.scalar.getValue()},getScaleCompositeY:function(){return this.scale.composite.y.getValue()*this.scalar.getValue()},
getScaleRadialX:function(){var e=this.scale.radial_composite.theta.getValue()*Math.PI/180,f=this.scale.radial_composite.radius.getValue();return Math.cos(e)*f*this.scalar.getValue()},getScaleRadialY:function(){var e=this.scale.radial_composite.theta.getValue()*Math.PI/180,f=this.scale.radial_composite.radius.getValue();return Math.sin(e)*f*this.scalar.getValue()},getRadialX:function(){var e=this.radial_composite.theta.getValue()*Math.PI/180,f=this.radial_composite.radius.getValue();return Math.cos(e)*
f},getRadialY:function(){var e=this.radial_composite.theta.getValue()*Math.PI/180,f=this.radial_composite.radius.getValue();return Math.sin(e)*f},getCompositeX:function(){return this.composite.x.getValue()},getCompositeY:function(){return this.composite.y.getValue()},getAddX:function(){return(this.add.lhs.getX()+this.add.rhs.getX())*this.add.scalar.getValue()},getAddY:function(){return(this.add.lhs.getY()+this.add.rhs.getY())*this.add.scalar.getValue()}}})();this.sifPlayer.param=this.sifPlayer.param||{};(function(){sifPlayer.param.integer={_setConvert:function(e,f,a,b){e=sifPlayer.param.integer;a===b?f.getValue=e.getValue:"add"===b&&(f.getValue=e.getAdd)},getValue:function(){return this.value},getAdd:function(){return(this.add.lhs.getValue()+this.add.rhs.getValue())*this.add.scalar.getValue()}}})();this.sifPlayer.param=this.sifPlayer.param||{};(function(){sifPlayer.param.real={_setConvert:function(e,f,a,b){e=sifPlayer.param.real;a===b?f.getValue=e.getValue:"add"===b&&(f.getValue=e.getAdd)},getValue:function(){return this.value},getAdd:function(){return(this.add.lhs.getValue()+this.add.rhs.getValue())*this.add.scalar.getValue()}}})();this.sifPlayer.param=this.sifPlayer.param||{};(function(){sifPlayer.param.angle={_setConvert:function(e,f,a,b){e=sifPlayer.param.angle;a===b?f.getValue=e.getValue:"add"===b&&(f.getValue=e.getAdd)},getValue:function(){return this.value},getAdd:function(){return(this.add.lhs.getValue()+this.add.rhs.getValue())*this.add.scalar.getValue()}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){sifPlayer.param.bool={_get:function(e,f,a,b,d){var g=sifPlayer.param,h,i;h={paused:!0,useTick:!0};var j=e.sifobj.timeline,k,m=0,l=[0,1];b[f]={};if(d.animated){d=d.animated.waypoint;b[f].value=d[0].bool._value;h=createjs.Tween.get(b[f],h);"0s"!==d[0]._time&&(k=sifPlayer.Ease.bool,i=sifPlayer._secsToMillis(d[0]._time),h.to({value:d[0].bool._value},i,k));for(var n=0;n<d.length-1;n++)k=l[1-m]?sifPlayer.Ease.bool:sifPlayer.Ease.constant,m=1-m,i=sifPlayer._secsToMillis(d[n+1]._time)-sifPlayer._secsToMillis(d[n]._time),
d[n].bool._value!==d[n+1].bool._value?h.to({value:d[n+1].bool._value},i,k):h.wait(i);j.addTween(h)}else d.bool||alert(JSON.stringify(d)+"param_type : bool param_name : "+f+" layer type : "+this.type),b[f].value=d.bool._value;g.convert._set(e,b[f],a,"bool")},_setConvert:function(e,f,a,b){e=sifPlayer.param.bool;a===b?f.getValue=e.getValue:"and"===b&&(f.getValue=e.getAnd)},getValue:function(){return this.value},getAnd:function(){return this.link1&&this.link2}}})();this.sifPlayer.param=this.sifPlayer.param||{};
(function(){var e={_get:function(f,a,b,d,e){var h=sifPlayer.param,i=h._set,j="composite";d[a]={};d[a]._type=j;d[a].composite={};if("vector"===e.composite._type)e[j]._x&&(e[j].x=f.sifobj.sif.canvas.defs[e[j]._x]),e[j]._y&&(e[j].y=f.sifobj.sif.canvas.defs[e[j]._y]),i(f,"x","real",d[a].composite,e.composite.x),i(f,"y","real",d[a].composite,e.composite.y),h.convert._set(f,d[a],b,j);else if("bline_point"===e.composite._type){var k=d[a].composite,j=e.composite._type;i(f,"point","vector",k,e.composite.point);
i(f,"width","real",k,e.composite.width);i(f,"origin","real",k,e.composite.origin);i(f,"split","bool",k,e.composite.split);i(f,"t1","vector",k,e.composite.t1);i(f,"t2","vector",k,e.composite.t2);h.convert._set(f,d[a].composite,b,j,e.composite.point.animated||e.composite.width.animated||e.composite.origin.animated||e.composite.t1.animated||e.composite.t2.animated)}},_setConvert:function(f,a,b,d){"bline_point"===d?(a.getPoint=e.getPoint,a.getT1=e.bline_point_getT1,a.getT2=e.bline_point_getT2):alert("new type of point")},
getPoint:function(){return this.point},bline_point_getPoint:function(){return this.point},bline_point_getT1:function(){return{x:this.t1.getX()/3,y:this.t1.getY()/3}},bline_point_getT2:function(){return{x:this.t2.getX()/3,y:this.t2.getY()/3}}};sifPlayer.param.composite=e})();this.sifPlayer.param=this.sifPlayer.param||{};this.sifPlayer.param.convert=this.sifPlayer.param.convert||{};(function(){sifPlayer.param.convert._set=function(e,f,a,b){"vector"===a?sifPlayer.param[a]._setConvert(e,f,a,b):"real"===a?sifPlayer.param[a]._setConvert(e,f,a,b):"integer"===a?sifPlayer.param[a]._setConvert(e,f,a,b):"angle"===a?sifPlayer.param[a]._setConvert(e,f,a,b):"bool"===a?sifPlayer.param[a]._setConvert(e,f,a,b):"composite"===a&&sifPlayer.param[a]._setConvert(e,f,a,b)}})();(function(){function e(){}var f=e.prototype;f.parent=null;f.sifobj=null;f.type=null;f.initLayer=function(a,b){a.hasOwnProperty("sifPath")?this.sifobj=a:(this.parent=a,this.sifobj=a.sifobj);this.type=b._type;b._desc&&(this.desc=b._desc,this.sifobj.desc[this.desc]=this);this.tween=[]};f.draw=function(){};f._getBlend=function(){switch(this.blend_method.value){case 0:return"source-over";case 1:return"copy";case 13:return"source-atop";case 21:return"source-in";case 12:return"destination-over";case 19:return"destination-out";
case 14:return"destination-in";default:return"source-over"}};f._getTotalAmount=function(){var a=this.amount.getValue(),b=this.parent;return b?b._getTotalAmount()*a:a};sifPlayer.Layer=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"blend_method","integer",this,b.blend_method);d(this,"amount","real",this,b.amount);d(this,"origin","vector",this,b.origin);d(this,"color","color",this,b.color);this._getBline(b.bline)};f.draw=function(a){var b,d;a.fillStyle="rgba("+Math.round(256*this.color.r)+", "+Math.round(256*this.color.g)+", "+Math.round(256*this.color.b)+", "+this.color.a+
")";a.globalAlpha=this._getTotalAmount();a.save();a.translate(this.origin.getX(),this.origin.getY());a.globalCompositeOperation=this._getBlend();a.beginPath();b=this.bline.entry[0].composite.getPoint();a.moveTo(b.getX(),b.getY());for(var e=0;e<this.bline.entry.length-1;e++)b=this.bline.entry[e].composite,d=this.bline.entry[e+1].composite,b.split.getValue()?this._bezierPart(a,b.getPoint(),d.getPoint(),b.getT2(),d.getT1()):this._bezierPart(a,b.getPoint(),d.getPoint(),b.getT1(),d.getT1());this.bline.loop&&
(b=this.bline.entry[this.bline.entry.length-1].composite,d=this.bline.entry[0].composite,b.split.getValue()?this._bezierPart(a,b.getPoint(),d.getPoint(),b.getT2(),d.getT1()):this._bezierPart(a,b.getPoint(),d.getPoint(),b.getT1(),d.getT1()));a.closePath();a.fill();a.restore()};f._getBline=function(a){var b=sifPlayer.param._set;this.bline={};this.bline.entry=[];this.bline.loop=a.bline._loop;for(var d=0,e=a.bline.entry.length;d<e;d++){var f={};b(this,"composite","composite",f,a.bline.entry[d]);this.bline.entry.push(f.composite)}};
f._bezierPart=function(a,b,d,e,f){var i;i=e.x+b.getX();b=e.y+b.getY();e=-f.x+d.getX();f=-f.y+d.getY();a.bezierCurveTo(i,b,e,f,d.getX(),d.getY())};sifPlayer.region=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"origin","vector",this,b.origin);d(this,"radius","real",this,b.radius);d(this,"blend_method","integer",this,b.blend_method);d(this,"color","color",this,b.color)};f.draw=function(a){var b=this.origin;a.fillStyle="rgba("+Math.round(256*this.color.r)+", "+Math.round(256*this.color.g)+", "+Math.round(256*this.color.b)+
", "+this.color.a+")";a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();a.beginPath();a.arc(b.getX(),b.getY(),this.radius.getValue(),0,2*Math.PI,!1);a.closePath();a.fill()};sifPlayer.circle=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"tl","vector",this,b.tl);d(this,"br","vector",this,b.br);this.image=new Image;this.image.src=this.sifobj.sifPath+b.filename.string};f.draw=function(a){a.save();a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();this._drawImage(a);
a.restore()};f._drawImage=function(a){var b=this.br.getX()-this.tl.getX(),d=this.tl.getY()-this.br.getY(),e,f;0>=b?(e=-1,b*=-1):e=1;0>=d?(f=1,d*=-1):f=-1;a.translate(this.tl.getX(),this.tl.getY());a.scale(e,f);a.drawImage(this.image,0,0,b,d)};sifPlayer.Import=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"p1","vector",this,b.p1);d(this,"p2","vector",this,b.p2);d(this,"gradient","gradient",this,b.gradient)};f.draw=function(a){for(var b=a.createLinearGradient(this.p1.getX(),this.p1.getY(),this.p2.getX(),this.p2.getY()),d=this.gradient.color,e=0,f=d.length;e<
f;e++)b.addColorStop(d[e].pos,"rgba("+Math.round(256*d[e].r)+", "+Math.round(256*d[e].g)+", "+Math.round(256*d[e].b)+", "+d[e].a+")");a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();a.fillStyle=b;a.fillRect(-1E3,-1E3,2E3,2E3)};sifPlayer.linear_gradient=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"origin","vector",this,b.origin);d(this,"zoom","real",this,b.zoom);d(this,"focus","vector",this,b.focus);this._getLayers(b.canvas.canvas.layer)};f._getLayers=function(a){this.layer=[];for(var b=0;b<a.length;b++)this.layer.push(sifPlayer._getLayer(this,a[b]))};
f.draw=function(a){var b=Math.exp(this.zoom.getValue()),d=this.layer,e=this.focus,f=this.origin;a.save();a.translate(e.getX(),e.getY());a.scale(b,b);a.translate(-e.getX(),-e.getY());a.translate(f.getX()/b,f.getY()/b);b=0;for(e=d.length;b<e;b++)d[b].draw(a);a.restore()};sifPlayer.PasteCanvas=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","real",this,b.amount);d(this,"blend_method","integer",this,b.blend_method);d(this,"center","vector",this,b.center);d(this,"radius","real",this,b.radius);d(this,"gradient","gradient",this,b.gradient)};f.draw=function(a){for(var b=this.center.getX(),d=this.center.getY(),b=a.createRadialGradient(b,d,0,b,d,this.radius.getValue()),d=this.gradient.color,
e=0,f=d.length;e<f;e++)b.addColorStop(d[e].pos,"rgba("+Math.round(256*d[e].r)+", "+Math.round(256*d[e].g)+", "+Math.round(256*d[e].b)+", "+d[e].a+")");a.globalAlpha=this._getTotalAmount();a.globalCompositeOperation=this._getBlend();a.fillStyle=b;a.fillRect(-1E3,-1E3,2E3,2E3)};sifPlayer.radial_gradient=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){this.initLayer(a,b)};f.draw=function(a){a.restore()};sifPlayer.restore=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"origin","vector",this,b.origin);d(this,"amount","angle",this,b.amount)};f.draw=function(a){a.save();a.translate(this.origin.getX(),this.origin.getY());a.rotate(this.amount.value*Math.PI/180);a.translate(-this.origin.getX(),-this.origin.getY())};sifPlayer.rotate=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"amount","vector",this,b.amount);d(this,"center","vector",this,b.center)};f.draw=function(a){var b=this.center,d=this.amount;a.save();a.translate(b.getX(),b.getY());a.scale(d.getX(),d.getY());a.translate(-b.getX(),-b.getY())};sifPlayer.stretch=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"origin","vector",this,b.origin)};f.draw=function(a){var b=this.origin;a.save();a.translate(b.getX(),b.getY())};sifPlayer.translate=e})();(function(){function e(a,b){this.init(a,b)}var f=e.prototype=new sifPlayer.Layer;f.init=function(a,b){var d=sifPlayer.param._set;this.initLayer(a,b);d(this,"center","vector",this,b.center);d(this,"amount","real",this,b.amount)};f.draw=function(a){var b=Math.exp(this.amount.getValue()),d=this.center;a.save();a.translate(d.getX(),d.getY());a.scale(b,b);a.translate(-d.getX()/b,-d.getY()/b)};sifPlayer.zoom=e})();
