<html lang='en'>
<head>
<meta charset='utf-8' />
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<style>
body {
margin: 0px;
overflow: hidden;
}
</style>
</head>
<body onload="main()">
<div id='sifPlayer'></div>
<canvas id="canvas"</canvas>
<script type='text/javascript' src="libs/Ticker.js"></script>
<script type='text/javascript' src="libs/tweenjs-0.4.0.min.js"></script>
<script type='text/javascript' src="src/tracker.js"></script>
<script type='text/javascript' src="src/sifplayer.js"></script>
<script type='text/javascript' src="src/Ease.js"></script>
<script type='text/javascript' src="src/sifobject.js"></script>
<script type='text/javascript' src="src/Param/param.js"></script>
<script type='text/javascript' src="src/Param/vector.js"></script>
<script type='text/javascript' src="src/Param/composite.js"></script>	
<script type='text/javascript' src="src/Param/integer.js"></script>
<script type='text/javascript' src="src/Param/real.js"></script>
<script type='text/javascript' src="src/Param/angle.js"></script>
<script type='text/javascript' src="src/Param/bool.js"></script>
<script type='text/javascript' src="src/Param/convert.js"></script>
<script type='text/javascript' src="src/Layer.js"></script>
<script type='text/javascript' src="src/Layers/PasteCanvas.js"></script>
<script type='text/javascript' src="src/Layers/region.js"></script>
<script type='text/javascript' src="src/Layers/outline.js"></script>
<script type='text/javascript' src="src/Layers/restore.js"></script>
<script type='text/javascript' src="src/Layers/translate.js"></script>
<script type='text/javascript' src="src/Layers/rotate.js"></script>
<script type='text/javascript' src="src/Layers/zoom.js"></script>
<script type='text/javascript' src="src/Layers/import.js"></script>
<script type='text/javascript' src="src/Layers/circle.js"></script>
<script type='text/javascript' src="src/Layers/linear_gradient.js"></script>
<script type='text/javascript' src="src/Layers/radial_gradient.js"></script>
<script type='text/javascript' src="src/Layers/stretch.js"></script>
<script type='text/javascript' src="src/Layers/timeloop.js"></script>


<script type='text/javascript'>
function main() {
	var xmlDoc = loadXML('assets/test.sif');
	var canvas = document.getElementById('canvas');
	var ctx = canvas.getContext('2d');
	
	var sif_width = xmlDoc.getElementsByTagName('canvas')[0].getAttribute('width');
	var sif_height = xmlDoc.getElementsByTagName('canvas')[0].getAttribute('height');
	setCanvasToWindowSize(canvas, sif_width, sif_height);
	
	var so = new sifPlayer.SifObject(xmlDoc , {x: 0, y: 0 , width: canvas.width, height: canvas.height, sifPath: 'assets/'});
	so.timeline.loop = true;

	createjs.Ticker.removeListener(so.timeline);

	var looper = {

		tick: function (delta) {
			so.tick(delta);
			so.draw(ctx);
		}
	}
	
	createjs.Ticker.useRaf = true;
	createjs.Ticker.addListener(looper);

	
}

function loadXML (file) {
	if (window.XMLHttpRequest)
	{// code for IE7+, Firefox, Chrome, Opera, Safari
		var xmlhttp=new XMLHttpRequest();

	} else {// code for IE6, IE5
		var xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
	}
	xmlhttp.open("GET",file,false);
	xmlhttp.send();
	var xmlDoc=xmlhttp.responseXML;
	return xmlDoc;
}

function setCanvasToWindowSize(canvas, width, height) {
	var wh = width / height;
	var iwh = window.innerWidth / window.innerHeight;
	if (wh > 1) {
		if (wh >= iwh) {
			canvas.width = window.innerWidth;
			canvas.height = canvas.width / wh;
		} else {
			canvas.height = window.innerHeight;
			canvas.width = canvas.height * wh;
		}
	} else {
		if (wh <= iwh) {
			canvas.height = window.innerHeight;
			canvas.width = canvas.height * wh;
		} else {
			canvas.width = window.innerWidth;
			canvas.height = canvas.width / wh;
		}
		
	}
}


</script>
</body>
</html>
